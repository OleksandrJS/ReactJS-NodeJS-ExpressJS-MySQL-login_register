(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{134:function(e,t,n){},316:function(e,t,n){"use strict";n.r(t);var a=n(4),r=n(2),s=n(45),c=n.n(s),i=(n(134),n(38)),o=n(8),l="userdata",u=n(7),d=n(21),j=n.n(d),m=n(33),b=n(34),h=n(39),p=n(26),O=n.n(p),g=n(122),f=n.n(g),x=(n(153),function(e){var t=e.formReg,n=t.username,s=t.email,c=t.login,i=t.password,l=e.handleChange,u=e.checked,d=e.handleCheck,b=e.birthDate,h=e.setBirthDate,p=e.handlerRegistration,g=e.regMessage,x=g.error,v=g.success,w=Object(r.useState)(null),y=Object(o.a)(w,2),S=y[0],C=y[1];Object(r.useEffect)((function(){(function(){var e=Object(m.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O()("http://localhost:5000/countries");case 2:t=e.sent,n=t.data,C(n.map((function(e){return e.country})));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("form",{onSubmit:p,className:"reg_form",children:[Object(a.jsx)("label",{children:"Registration"}),Object(a.jsx)("input",{className:"input-text",name:"email",onChange:l,value:s,placeholder:"email"}),Object(a.jsx)("input",{className:"input-text",name:"login",onChange:l,value:c,placeholder:"login"}),Object(a.jsx)("input",{className:"input-text",type:"password",name:"password",onChange:l,value:i,placeholder:"password"}),Object(a.jsx)("input",{className:"input-text",name:"username",onChange:l,value:n,placeholder:"name"}),Object(a.jsxs)("select",{onChange:l,onClick:function(e){return e.target.className="select-active"},defaultValue:"",name:"country",children:[Object(a.jsx)("option",{hidden:!0,value:"",children:"Select your Country"}),null!==S&&S.sort().map((function(e,t){return Object(a.jsx)("option",{value:e,children:e},t)}))]}),Object(a.jsx)(f.a,{selected:b,onChange:function(e){return h(e)},placeholderText:"Select you birth date",maxDate:new Date,dateFormat:"dd/MM/yyyy",showYearDropdown:!0,yearDropdownItemNumber:40,scrollableYearDropdown:!0}),Object(a.jsxs)("div",{className:"terms",children:[Object(a.jsx)("input",{type:"checkbox",onChange:d,checked:u,style:{cursor:"pointer"}}),Object(a.jsx)("p",{onClick:d,children:"agree with terms and conditions"})]}),Object(a.jsx)("button",{className:"btn",type:"submit",children:"Sign up"})]}),Object(a.jsx)("p",{className:"Error",children:x}),Object(a.jsx)("p",{className:"Success",children:v})]})}),v=function(){return Object(a.jsxs)("div",{className:"auth-links",children:[Object(a.jsx)(i.b,{activeClassName:"is-active",to:"/",exact:!0,children:"Sign Up"}),Object(a.jsx)(i.b,{activeClassName:"is-active",to:"/signIn",children:"Sign In"})]})},w=n(13),y=w.d().shape({email:w.e().email().required(),login:w.e().required(),password:w.e().required(),username:w.e().required(),country:w.e().required(),dayOfTheBirth:w.c().default((function(){return new Date})).required(),checked:w.b().oneOf([!0],"Field must be checked").required()}),S=function(){var e=Object(r.useState)({email:"",login:"",password:"",username:"",country:""}),t=Object(o.a)(e,2),n=t[0],s=t[1],c=Object(r.useState)(""),i=Object(o.a)(c,2),l=i[0],u=i[1],d=Object(r.useState)(!1),p=Object(o.a)(d,2),g=p[0],f=p[1],w=Object(r.useState)({error:"",success:""}),S=Object(o.a)(w,2),C=S[0],N=S[1],k=+new Date,D=function(e,t){N({error:e,success:t}),setTimeout((function(){return N({error:"",success:""})}),5e3)},L=function(){var e=Object(m.a)(j.a.mark((function e(t){var a,r,s,c,i,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=n.email,r=n.login,s=n.password,c=n.username,i=n.country,o={email:a,login:r,password:s,username:c,country:i,birthDate:l,checked:g},e.next=5,y.isValid(o);case 5:e.sent&&a!==r?O.a.post("http://localhost:5000/auth/register",{email:n.email,login:n.login,password:n.password,username:n.username,country:n.country,timestamp:k,birth_date:l}).then((function(e){D(e.data.error||"",e.data.message||"")})):D(a===r&&""!==r&&""!==a?"Email and login must be unique":"All fields must be filled","");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(v,{}),Object(a.jsx)(x,{formReg:n,birthDate:l,setBirthDate:u,checked:g,handleChange:function(e){return s(Object(h.a)(Object(h.a)({},n),{},Object(b.a)({},e.target.name,e.target.value)))},handleCheck:function(){return f((function(e){return!e}))},handlerRegistration:L,regMessage:C})]})},C=function(e){var t=e.formLogin,n=t.emailOrLogin,r=t.password,s=e.handleLoginForm,c=e.handlerSignin,i=e.signInMessage;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("form",{onSubmit:c,className:"signin_form",children:[Object(a.jsx)("label",{children:"Sign in"}),Object(a.jsx)("input",{className:"input-text",name:"emailOrLogin",onChange:s,value:n,placeholder:"login or email"}),Object(a.jsx)("input",{className:"input-text",name:"password",type:"password",onChange:s,value:r,placeholder:"password"}),Object(a.jsx)("button",{className:"btn",type:"submit",children:"Sign in"})]}),Object(a.jsx)("p",{className:"Error",children:i})]})},N=w.d().shape({emailOrLogin:w.e().required(),password:w.e().required()}),k=function(){var e=Object(r.useContext)(L).login,t=Object(r.useState)({emailOrLogin:"",password:""}),n=Object(o.a)(t,2),s=n[0],c=n[1],i=Object(r.useState)(""),l=Object(o.a)(i,2),u=l[0],d=l[1],p=function(){setTimeout((function(){return d("")}),5e3)},g=function(){var t=Object(m.a)(j.a.mark((function t(n){var a,r,c;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),a=s.emailOrLogin,r=s.password,c={emailOrLogin:a,password:r},t.next=5,N.isValid(c);case 5:t.sent?O.a.post("http://localhost:5000/auth/signin/email",{email:s.emailOrLogin,password:s.password}).then((function(t){if(console.log(t),(0===t.data.length||t.data.message)&&O.a.post("http://localhost:5000/auth/signin/login",{login:s.emailOrLogin,password:s.password}).then((function(t){if(console.log(t),d(t.data.message),p(),0!==t.data.length&&!t.data.message){var n=t.data[0],a=n.username,r=n.email;e(a,r)}})),!t.data.message){var n=t.data[0],a=n.username,r=n.email;e(a,r)}})):(d("All fields must be filled"),p());case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(v,{}),Object(a.jsx)(C,{formLogin:s,handleLoginForm:function(e){return c(Object(h.a)(Object(h.a)({},s),{},Object(b.a)({},e.target.name,e.target.value)))},handlerSignin:g,signInMessage:u})]})},D=function(){var e=Object(r.useContext)(L),t=e.logout,n=e.username,s=e.userEmail;return Object(a.jsxs)("div",{children:[Object(a.jsxs)("h3",{children:["Welcome, ",n]}),Object(a.jsxs)("h5",{children:["email: ",s]}),Object(a.jsx)("button",{className:"btn",onClick:t,children:"Log out"})]})},L=Object(r.createContext)();var E=function(){var e=function(){var e=Object(r.useState)(null),t=Object(o.a)(e,2),n=t[0],a=t[1],s=Object(r.useState)(null),c=Object(o.a)(s,2),i=c[0],u=c[1],d=Object(r.useState)(!1),j=Object(o.a)(d,2),m=j[0],b=j[1],h=Object(r.useCallback)((function(e,t){b(!0),a(e),u(t),localStorage.setItem(l,JSON.stringify({username:e,userEmail:t,isAuthenticated:!0}))}),[]),p=Object(r.useCallback)((function(){b(!1),a(null),u(null),localStorage.removeItem(l)}),[]);return Object(r.useEffect)((function(){var e=JSON.parse(localStorage.getItem(l));e&&(b(e.isAuthenticated),a(e.username),u(e.userEmail))}),[h]),{login:h,logout:p,isAuthenticated:m,username:n,userEmail:i}}(),t=e.login,n=e.logout,s=e.username,c=e.userEmail,d=function(e){return e?Object(a.jsxs)(u.d,{children:[Object(a.jsx)(u.b,{path:"/user",exact:!0,children:Object(a.jsx)(D,{})}),Object(a.jsx)(u.a,{to:"/user"})]}):Object(a.jsxs)(u.d,{children:[Object(a.jsx)(u.b,{path:"/",exact:!0,children:Object(a.jsx)(S,{})}),Object(a.jsx)(u.b,{path:"/signin",children:Object(a.jsx)(k,{})}),Object(a.jsx)(u.a,{to:"/"})]})}(e.isAuthenticated);return Object(a.jsx)("div",{className:"form-wrapper",children:Object(a.jsx)(L.Provider,{value:{login:t,logout:n,username:s,userEmail:c},children:Object(a.jsx)(i.a,{children:d})})})};c.a.render(Object(a.jsx)(E,{}),document.getElementById("root"))}},[[316,1,2]]]);
//# sourceMappingURL=main.78a7bf68.chunk.js.map