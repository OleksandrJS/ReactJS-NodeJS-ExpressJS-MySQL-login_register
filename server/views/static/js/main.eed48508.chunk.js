(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{134:function(e,t,a){},316:function(e,t,a){"use strict";a.r(t);var n=a(4),r=a(2),s=a(45),c=a.n(s),i=(a(134),a(38)),o=a(8),l="userdata",u=a(7),d=function(e){var t=e.formLogin,a=t.emailOrLogin,r=t.password,s=e.handleLoginForm,c=e.handlerSignin,i=e.signInMessage;return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)("form",{onSubmit:c,className:"signin_form",children:[Object(n.jsx)("label",{children:"Sign in"}),Object(n.jsx)("input",{className:"input-text",name:"emailOrLogin",onChange:s,value:a,placeholder:"login or email"}),Object(n.jsx)("input",{className:"input-text",name:"password",type:"password",onChange:s,value:r,placeholder:"password"}),Object(n.jsx)("button",{className:"btn",type:"submit",children:"Sign in"})]}),Object(n.jsx)("p",{className:"Error",children:i})]})},j=a(21),h=a.n(j),m=a(33),b=a(34),O=a(39),g=a(26),p=a.n(g),f=a(122),x=a.n(f),v=(a(153),function(e){var t=e.formReg,a=t.username,s=t.email,c=t.login,i=t.password,l=e.handleChange,u=e.checked,d=e.handleCheck,j=e.birthDate,b=e.setBirthDate,O=e.handlerRegistration,g=e.regMessage,f=g.error,v=g.success,w=e.setDayOfTheBirth,y=Object(r.useState)(null),S=Object(o.a)(y,2),C=S[0],N=S[1];return Object(r.useEffect)((function(){(function(){var e=Object(m.a)(h.a.mark((function e(){var t,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p()("http://localhost:5000/countries");case 2:t=e.sent,a=t.data,N(a.map((function(e){return e.country})));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(n.jsxs)(n.Fragment,{children:[Object(n.jsxs)("form",{onSubmit:O,className:"reg_form",children:[Object(n.jsx)("label",{children:"Registration"}),Object(n.jsx)("input",{className:"input-text",name:"email",onChange:l,value:s,placeholder:"email"}),Object(n.jsx)("input",{className:"input-text",name:"login",onChange:l,value:c,placeholder:"login"}),Object(n.jsx)("input",{className:"input-text",type:"password",name:"password",onChange:l,value:i,placeholder:"password"}),Object(n.jsx)("input",{className:"input-text",name:"username",onChange:l,value:a,placeholder:"name"}),Object(n.jsxs)("select",{onChange:l,name:"country",children:[Object(n.jsx)("option",{value:"0",disabled:!0,selected:!0,children:"Select your Country"}),null!==C&&C.sort().map((function(e,t){return Object(n.jsx)("option",{value:e,children:e},t)}))]}),Object(n.jsx)(x.a,{selected:j,onChange:function(e){var t=e.getDate()+"-"+(+e.getMonth()+1)+"-"+e.getFullYear();b(e),w(t)},placeholderText:"Select you birth date",maxDate:new Date,dateFormat:"dd/MM/yyyy",showYearDropdown:!0,yearDropdownItemNumber:40,scrollableYearDropdown:!0}),Object(n.jsxs)("div",{className:"terms",children:[Object(n.jsx)("input",{type:"checkbox",onChange:d,defaultChecked:u}),Object(n.jsx)("p",{children:"agree with terms and conditions"})]}),Object(n.jsx)("button",{className:"btn",type:"submit",children:"Sign up"})]}),Object(n.jsx)("p",{className:"Error",children:f}),Object(n.jsx)("p",{className:"Success",children:v})]})}),w=function(){return Object(n.jsxs)("div",{className:"auth-links",children:[Object(n.jsx)(i.b,{activeClassName:"is-active",to:"/",exact:!0,children:"Sign Up"}),Object(n.jsx)(i.b,{activeClassName:"is-active",to:"/signIn",children:"Sign In"})]})},y=a(13),S=y.c().shape({email:y.d().email().required(),login:y.d().required(),password:y.d().required(),username:y.d().required(),country:y.d().required(),dayOfTheBirth:y.d().required(),checked:y.b().oneOf([!0],"Field must be checked").required()}),C=function(){var e=Object(r.useState)({email:"",login:"",password:"",username:"",country:""}),t=Object(o.a)(e,2),a=t[0],s=t[1],c=Object(r.useState)(""),i=Object(o.a)(c,2),l=i[0],u=i[1],d=Object(r.useState)(!1),j=Object(o.a)(d,2),g=j[0],f=j[1],x=Object(r.useState)({error:"",success:""}),y=Object(o.a)(x,2),C=y[0],N=y[1],k=Object(r.useState)(""),D=Object(o.a)(k,2),L=D[0],E=D[1],q=+new Date,F=function(){setTimeout((function(){return N({error:"",success:""})}),5e3)},I=function(){var e=Object(m.a)(h.a.mark((function e(t){var n,r,s,c,i,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=a.email,r=a.login,s=a.password,c=a.username,i=a.country,o={email:n,login:r,password:s,username:c,country:i,dayOfTheBirth:L,checked:g},e.next=5,S.isValid(o);case 5:e.sent?p.a.post("http://localhost:5000/auth/register",{email:a.email,login:a.login,password:a.password,username:a.username,country:a.country,timestamp:q,birth_date:L}).then((function(e){N({error:"",success:e.data.message}),F()})):(N({error:"All fields must be filled",success:""}),F());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(w,{}),Object(n.jsx)(v,{formReg:a,birthDate:l,setBirthDate:u,checked:g,handleChange:function(e){return s(Object(O.a)(Object(O.a)({},a),{},Object(b.a)({},e.target.name,e.target.value)))},handleCheck:function(){return f((function(e){return!e}))},handlerRegistration:I,regMessage:C,setDayOfTheBirth:E})]})},N=y.c().shape({emailOrLogin:y.d().required(),password:y.d().required()}),k=function(){var e=Object(r.useContext)(L).login,t=Object(r.useState)({emailOrLogin:"",password:""}),a=Object(o.a)(t,2),s=a[0],c=a[1],i=Object(r.useState)(""),l=Object(o.a)(i,2),u=l[0],j=l[1],g=function(){setTimeout((function(){return j("")}),5e3)},f=function(){var t=Object(m.a)(h.a.mark((function t(a){var n,r,c;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),n=s.emailOrLogin,r=s.password,c={emailOrLogin:n,password:r},t.next=5,N.isValid(c);case 5:t.sent?p.a.post("http://localhost:5000/auth/signin/email",{email:s.emailOrLogin,password:s.password}).then((function(t){if(console.log(t),(0===t.data.length||t.data.message)&&p.a.post("http://localhost:5000/auth/signin/login",{login:s.emailOrLogin,password:s.password}).then((function(t){if(console.log(t),j(t.data.message),g(),0!==t.data.length&&!t.data.message){var a=t.data[0],n=a.username,r=a.email;e(n,r)}})),!t.data.message){var a=t.data[0],n=a.username,r=a.email;e(n,r)}})):(j("All fields must be filled"),g());case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(w,{}),Object(n.jsx)(d,{formLogin:s,handleLoginForm:function(e){return c(Object(O.a)(Object(O.a)({},s),{},Object(b.a)({},e.target.name,e.target.value)))},handlerSignin:f,signInMessage:u})]})},D=function(){var e=Object(r.useContext)(L),t=e.logout,a=e.username,s=e.userEmail;return Object(n.jsxs)("div",{children:[Object(n.jsxs)("h3",{children:["Welcome, ",a]}),Object(n.jsxs)("h5",{children:["email: ",s]}),Object(n.jsx)("button",{className:"btn",onClick:t,children:"Log out"})]})},L=Object(r.createContext)();var E=function(){var e=function(){var e=Object(r.useState)(null),t=Object(o.a)(e,2),a=t[0],n=t[1],s=Object(r.useState)(null),c=Object(o.a)(s,2),i=c[0],u=c[1],d=Object(r.useState)(!1),j=Object(o.a)(d,2),h=j[0],m=j[1],b=Object(r.useCallback)((function(e,t){m(!0),n(e),u(t),localStorage.setItem(l,JSON.stringify({username:e,userEmail:t,isAuthenticated:!0}))}),[]),O=Object(r.useCallback)((function(){m(!1),n(null),u(null),localStorage.removeItem(l)}),[]);return Object(r.useEffect)((function(){var e=JSON.parse(localStorage.getItem(l));e&&(m(e.isAuthenticated),n(e.username),u(e.userEmail))}),[b]),{login:b,logout:O,isAuthenticated:h,username:a,userEmail:i}}(),t=e.login,a=e.logout,s=e.username,c=e.userEmail,d=function(e){return e?Object(n.jsxs)(u.d,{children:[Object(n.jsx)(u.b,{path:"/user",exact:!0,children:Object(n.jsx)(D,{})}),Object(n.jsx)(u.a,{to:"/user"})]}):Object(n.jsxs)(u.d,{children:[Object(n.jsx)(u.b,{path:"/",exact:!0,children:Object(n.jsx)(C,{})}),Object(n.jsx)(u.b,{path:"/signin",children:Object(n.jsx)(k,{})}),Object(n.jsx)(u.a,{to:"/"})]})}(e.isAuthenticated);return Object(n.jsx)("div",{className:"form-wrapper",children:Object(n.jsx)(L.Provider,{value:{login:t,logout:a,username:s,userEmail:c},children:Object(n.jsx)(i.a,{children:d})})})};c.a.render(Object(n.jsx)(E,{}),document.getElementById("root"))}},[[316,1,2]]]);
//# sourceMappingURL=main.eed48508.chunk.js.map