(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{134:function(e,t,n){},316:function(e,t,n){"use strict";n.r(t);var a=n(4),r=n(2),s=n(45),c=n.n(s),i=(n(134),n(38)),u=n(8),o="userdata",l=n(7),j=n(21),d=n.n(j),m=n(32),b=n(33),h=n(39),p=n(34),O=n.n(p),g=n(122),x=n.n(g),f=(n(153),function(e){var t=e.formReg,n=t.username,s=t.email,c=t.login,i=t.password,o=e.handleChange,l=e.checked,j=e.handleCheck,b=e.birthDate,h=e.setBirthDate,p=e.handlerRegistration,g=e.regMessage,f=g.error,v=g.success,w=Object(r.useState)(null),y=Object(u.a)(w,2),S=y[0],C=y[1];Object(r.useEffect)((function(){(function(){var e=Object(m.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O()("https://login-mysql-app.herokuapp.com/countries");case 2:t=e.sent,n=t.data,C(n.map((function(e){return e.country})));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);var N=new Date;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("form",{onSubmit:p,className:"reg_form",children:[Object(a.jsx)("label",{children:"Registration"}),Object(a.jsx)("input",{className:"input-text",name:"email",onChange:o,value:s,placeholder:"email"}),Object(a.jsx)("input",{className:"input-text",name:"login",onChange:o,value:c,placeholder:"login"}),Object(a.jsx)("input",{className:"input-text",type:"password",name:"password",onChange:o,value:i,placeholder:"password"}),Object(a.jsx)("input",{className:"input-text",name:"username",onChange:o,value:n,placeholder:"name"}),Object(a.jsxs)("select",{onChange:o,onClick:function(e){return e.target.className="select-active"},defaultValue:"",name:"country",children:[Object(a.jsx)("option",{hidden:!0,value:"",children:"Select your Country"}),null!==S&&S.sort().map((function(e,t){return Object(a.jsx)("option",{value:e,children:e},t)}))]}),Object(a.jsx)(x.a,{selected:b,onChange:function(e){return h(e)},placeholderText:"Select you birth date",maxDate:N.setFullYear(N.getFullYear()-10),dateFormat:"dd/MM/yyyy",showYearDropdown:!0,yearDropdownItemNumber:40,scrollableYearDropdown:!0}),Object(a.jsxs)("div",{className:"terms",children:[Object(a.jsx)("input",{type:"checkbox",onChange:j,checked:l,style:{cursor:"pointer"}}),Object(a.jsx)("p",{onClick:j,children:"agree with terms and conditions"})]}),Object(a.jsx)("button",{className:"btn",type:"submit",children:"Sign up"})]}),Object(a.jsx)("p",{className:"Error",children:f}),Object(a.jsx)("p",{className:"Success",children:v})]})}),v=function(){return Object(a.jsxs)("div",{className:"auth-links",children:[Object(a.jsx)(i.b,{activeClassName:"is-active",to:"/",exact:!0,children:"Sign Up"}),Object(a.jsx)(i.b,{activeClassName:"is-active",to:"/signIn",children:"Sign In"})]})},w=n(13),y=w.d().shape({email:w.e().email().required(),login:w.e().required(),password:w.e().required(),username:w.e().required(),country:w.e().required(),dayOfTheBirth:w.c().default((function(){return new Date})).required(),checked:w.b().oneOf([!0]).required()}),S=function(){var e=Object(r.useState)({email:"",login:"",password:"",username:"",country:""}),t=Object(u.a)(e,2),n=t[0],s=t[1],c=Object(r.useState)(""),i=Object(u.a)(c,2),o=i[0],l=i[1],j=Object(r.useState)(!1),p=Object(u.a)(j,2),g=p[0],x=p[1],w=Object(r.useState)({error:"",success:""}),S=Object(u.a)(w,2),C=S[0],N=S[1],k=+new Date,D=function(e,t){N({error:e,success:t}),setTimeout((function(){return N({error:"",success:""})}),5e3)},q=function(){var e=Object(m.a)(d.a.mark((function e(t){var a,r,s,c,i,u;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=n.email,r=n.login,s=n.password,c=n.username,i=n.country,u={email:a,login:r,password:s,username:c,country:i,birthDate:o,checked:g},e.next=5,y.isValid(u);case 5:e.sent&&a!==r?O.a.post("https://login-mysql-app.herokuapp.com/auth/register",{email:a,login:r,password:s,username:c,country:i,timestamp:k,birth_date:o}).then((function(e){D(e.data.error||"",e.data.message||"")})):D(a===r&&""!==r&&""!==a?"Email and login must be unique":"All fields must be filled","");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(v,{}),Object(a.jsx)(f,{formReg:n,birthDate:o,setBirthDate:l,checked:g,handleChange:function(e){return s(Object(h.a)(Object(h.a)({},n),{},Object(b.a)({},e.target.name,e.target.value)))},handleCheck:function(){return x((function(e){return!e}))},handlerRegistration:q,regMessage:C})]})},C=function(e){var t=e.formLogin,n=t.emailOrLogin,r=t.password,s=e.handleLoginForm,c=e.handlerSignin,i=e.signInMessage;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("form",{onSubmit:c,className:"signin_form",children:[Object(a.jsx)("label",{children:"Sign in"}),Object(a.jsx)("input",{className:"input-text",name:"emailOrLogin",onChange:s,value:n,placeholder:"login or email"}),Object(a.jsx)("input",{className:"input-text",name:"password",type:"password",onChange:s,value:r,placeholder:"password"}),Object(a.jsx)("button",{className:"btn",type:"submit",children:"Sign in"})]}),Object(a.jsx)("p",{className:"Error",children:i})]})},N=w.d().shape({emailOrLogin:w.e().required(),password:w.e().required()}),k=function(){var e=Object(r.useContext)(q).login,t=Object(r.useState)({emailOrLogin:"",password:""}),n=Object(u.a)(t,2),s=n[0],c=n[1],i=Object(r.useState)(""),o=Object(u.a)(i,2),l=o[0],j=o[1],p=function(){setTimeout((function(){return j("")}),5e3)},g=function(){var t=Object(m.a)(d.a.mark((function t(n){var a,r,c;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),a=s.emailOrLogin,r=s.password,c={emailOrLogin:a,password:r},t.next=5,N.isValid(c);case 5:t.sent?O.a.post("https://login-mysql-app.herokuapp.com/auth/signin",{email:a,password:r}).then((function(t){if(t.data.message)j(t.data.message),p();else{var n=t.data,a=n.username,r=n.email;e(a,r)}})):(j("All fields must be filled"),p());case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(v,{}),Object(a.jsx)(C,{formLogin:s,handleLoginForm:function(e){return c(Object(h.a)(Object(h.a)({},s),{},Object(b.a)({},e.target.name,e.target.value)))},handlerSignin:g,signInMessage:l})]})},D=function(){var e=Object(r.useContext)(q),t=e.logout,n=e.username,s=e.userEmail;return Object(a.jsxs)("div",{children:[Object(a.jsxs)("h3",{children:["Welcome, ",n]}),Object(a.jsxs)("h5",{children:["email: ",s]}),Object(a.jsx)("button",{className:"btn",onClick:t,children:"Log out"})]})},q=Object(r.createContext)();var E=function(){var e=function(){var e=Object(r.useState)(null),t=Object(u.a)(e,2),n=t[0],a=t[1],s=Object(r.useState)(null),c=Object(u.a)(s,2),i=c[0],l=c[1],j=Object(r.useState)(!1),d=Object(u.a)(j,2),m=d[0],b=d[1],h=Object(r.useCallback)((function(e,t){b(!0),a(e),l(t),localStorage.setItem(o,JSON.stringify({username:e,userEmail:t,isAuthenticated:!0}))}),[]),p=Object(r.useCallback)((function(){b(!1),a(null),l(null),localStorage.removeItem(o)}),[]);return Object(r.useEffect)((function(){var e=JSON.parse(localStorage.getItem(o));e&&(b(e.isAuthenticated),a(e.username),l(e.userEmail))}),[h]),{login:h,logout:p,isAuthenticated:m,username:n,userEmail:i}}(),t=e.login,n=e.logout,s=e.username,c=e.userEmail,j=function(e){return e?Object(a.jsxs)(l.d,{children:[Object(a.jsx)(l.b,{path:"/user",exact:!0,children:Object(a.jsx)(D,{})}),Object(a.jsx)(l.a,{to:"/user"})]}):Object(a.jsxs)(l.d,{children:[Object(a.jsx)(l.b,{path:"/",exact:!0,children:Object(a.jsx)(S,{})}),Object(a.jsx)(l.b,{path:"/signin",children:Object(a.jsx)(k,{})}),Object(a.jsx)(l.a,{to:"/"})]})}(e.isAuthenticated);return Object(a.jsx)("div",{className:"form-wrapper",children:Object(a.jsx)(q.Provider,{value:{login:t,logout:n,username:s,userEmail:c},children:Object(a.jsx)(i.a,{children:j})})})};c.a.render(Object(a.jsx)(E,{}),document.getElementById("root"))}},[[316,1,2]]]);
//# sourceMappingURL=main.b491cc7c.chunk.js.map